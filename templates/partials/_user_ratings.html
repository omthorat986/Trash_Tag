<div class="card glass p-6">
  <h2 class="section-title">⭐ Rate Cleaners</h2>
  <p class="text-gray-600 mb-4">Thank you for helping keep quality high — please rate the cleaners who completed your requests.</p>

  <div class="overflow-x-auto">
    <table class="min-w-full text-sm bg-white rounded-lg overflow-hidden shadow">
      <thead class="bg-emerald-600 text-white">
        <tr>
          <th class="px-4 py-3 text-left">Location</th>
          <th class="px-4 py-3 text-left">Cleaner</th>
          <th class="px-4 py-3 text-left">Completed At</th>
          <th class="px-4 py-3 text-left">Your Rating</th>
        </tr>
      </thead>
      <tbody class="divide-y">
        {% for rep in completed_reports %}
        <tr>
          <td class="px-4 py-3">{{ rep.location }}</td>
          <td class="px-4 py-3">{{ rep.submitted_by_cleaner.username if rep.submitted_by_cleaner else 'Unknown' }}</td>
          <td class="px-4 py-3">{{ rep.created_at.strftime('%Y-%m-%d %H:%M') }}</td>
          <td class="px-4 py-3">
            {% if not rep.rating %}
            <form action="{{ url_for('rate_cleaner', report_id=rep.id) }}" method="POST" class="flex items-center gap-2">
              <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
              <select name="rating" required class="border p-1 rounded">
                <option value="">Rate</option>
                {% for i in range(1,6) %}
                  <option value="{{ i }}">{{ i }}</option>
                {% endfor %}
              </select>
              <button type="submit" class="bg-emerald-600 text-white px-3 py-1 rounded">Submit</button>
            </form>
            {% else %}
              <div>⭐ {{ rep.rating }}/5</div>
            {% endif %}
          </td>
        </tr>
        {% else %}
          <tr><td colspan="4" class="px-4 py-6 text-center text-gray-500">No completed cleanups to rate yet.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>